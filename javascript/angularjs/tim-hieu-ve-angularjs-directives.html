<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Tìm hiểu về angularjs directives &#8211; xuantain's blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Đây là bài viết tìm hỉẻr về Directive trong AngularJS, và cách tạo Custom Directive.">
    <meta name="author" content="Nguyen Xuan tai">
    <meta name="keywords" content="javascript, angularjs">
    <link rel="canonical" href="http://xuantain.github.io/javascript/angularjs/tim-hieu-ve-angularjs-directives.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Tìm hiểu về angularjs directives">
    <meta property="og:description" content="A simple, beautiful theme for Jekyll that emphasizes content rather than aesthetic fluff.">
    <meta property="og:url" content="http://xuantain.github.io/javascript/angularjs/tim-hieu-ve-angularjs-directives.html">
    <meta property="og:site_name" content="xuantain's blog">
</head>

<body class="">
  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://xuantain.github.io" class="site-title">xuantain's blog</a>
      <nav class="site-nav right">
        <a href="/about/">About</a>
<a href="/contact/">Contact</a>

      </nav>
      <div class="clearfix"></div>
      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1 class="py2">Tìm hiểu về angularjs directives</h1>
  <span class="post-meta">Oct 24, 2014</span><br>
  
  <span class="post-meta small">6 minute read</span>
</div>

<article class="post-content">
  <h3 id="angular-directive">Angular Directive</h3>

<p>Các thuộc tính, id, class, name, onClick, onChange, … của một DOM element được gọi chung là directive. AngularJS sẽ dựa vào những directive đó để đính kèm các chỉ thị hoặc các sự kiện tới DOM element cần xử lý. </p>

<p>Để hiểu về Directive trong AngularJS, các bạn xem qua tình huống sau:
Giả sử trong tình huống bạn muốn hiển thị nhiều vùng dữ liệu có cùng format về giao diện, nhưng khác nhau về nội dung dữ liệu thì có nhiều cách để thực hiện.</p>

<ul>
  <li>Cách 1: Bạn có thể viết code ở những vị trí cần hiển thị. Cách này chắc chắn code sẽ rất thừa thải và không có khả năng tái sử dụng, rất cực khổ khi bạn muốn thay đổi format giao diện cho phần hiển thị đó, vì phải tìm đến từng nơi.</li>
  <li>Cách 2: Bạn có thể tạo một template chung và sử dụng javascript hay jQuery để đưa dữ liệu vào template mỗi khi gọi, nhưng cách này chỉ mới nghĩ thôi đã thấy rối rắm, và chắc chắn code để xử lý tình huống này sẽ không ít và đôi khi có thể là phức tạp.</li>
  <li>Cách 3: Bạn có thể sử dụng AngularJS và tạo một directive cho phần hiển thị đó. Cách này rất gọn gàng và tường minh, có thể tái sử dụng ở nhiều nơi, việc chỉnh sửa cũng dễ dàng hơn.</li>
</ul>

<p>Tình huống trên đưa ra chỉ để giúp bạn dễ hình dung về directive, nhưng chưa nói lên đầy đủ ý nghĩa của directive. Bài viết này sẽ đưa ra những demo và giải thích để bạn hiểu rõ hơn.</p>

<h2 id="angularjs-directive-hot-ng-nh-th-no">AngularJS Directive hoạt động như thế nào?</h2>
<p>Khi trình biên dịch HTML render ra các DOM element, nó sẽ quét qua toàn bộ các element bên trong theo trình tự từ trên xuống dưới, nếu gặp DOM element có khai báo directive khớp với directive của AngularJS, hoặc là custom directive thì DOM element đó sẽ được Angular theo dõi các sự kiện tác động lên nó để đưa ra các xử lý tương ứng mà directive đó đã định nghĩa. </p>

<p>AngularJS có sẵn một bộ directive: ng-app, ng-module, ng-controller, ng-bind, …  Để phát triển ứng dụng với AngularJS thì cần phải nắm rõ cách hoạt động và mục đích sử dụng của những directive đó. Trong phạm vi bài viết này sẽ không giải thích và hướng dẫn cách dùng những directive sẵn có của AngularJS.</p>

<p>Tạo custom directive:
Tên của Angular Directive được viết theo kiểu <a href="http://en.wikipedia.org/wiki/CamelCase">camelCase</a>.</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">angular</span><span class="o">.</span><span class="n">module</span><span class="p">(</span><span class="s1">&#39;myDemoModule&#39;</span><span class="p">,</span> <span class="o">[]</span><span class="p">)</span>
  <span class="o">.</span><span class="n">directive</span><span class="p">(</span><span class="s1">&#39;myDemoDirective&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(){</span>
	   <span class="k">return</span> <span class="p">{</span>
	<span class="sr">//</span> <span class="no">TODO</span>
   <span class="p">};</span>
<span class="p">});</span></code></pre></div>

<p>index.html</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">&lt;</span><span class="n">div</span> <span class="n">ng</span><span class="o">-</span><span class="n">app</span><span class="o">=</span><span class="s2">&quot;myDemoModule&quot;</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="n">div</span> <span class="n">ng</span><span class="o">-</span><span class="n">controller</span><span class="o">=</span><span class="s2">&quot;demoController&quot;</span><span class="o">&gt;</span>
        <span class="no">Hello</span> <span class="o">&lt;</span><span class="n">input</span> <span class="n">ng</span><span class="o">-</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">hr</span><span class="o">/&gt;</span>
  	    <span class="o">&lt;</span><span class="n">span</span> <span class="n">ng</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="o">&gt;&lt;</span><span class="sr">/span&gt; &lt;br/</span><span class="o">&gt;</span>
	    <span class="o">&lt;</span><span class="n">span</span> <span class="ss">ng</span><span class="p">:</span><span class="n">bind</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="o">&gt;&lt;</span><span class="sr">/span&gt; &lt;br/</span><span class="o">&gt;</span>
	    <span class="o">&lt;</span><span class="n">span</span> <span class="n">ng_bind</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="o">&gt;&lt;</span><span class="sr">/span&gt; &lt;br/</span><span class="o">&gt;</span>
	    <span class="o">&lt;</span><span class="n">span</span> <span class="n">data</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="o">&gt;&lt;</span><span class="sr">/span&gt; &lt;br/</span><span class="o">&gt;</span>
	    <span class="o">&lt;</span><span class="n">span</span> <span class="n">x</span><span class="o">-</span><span class="n">ng</span><span class="o">-</span><span class="n">bind</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="o">&gt;&lt;</span><span class="sr">/span&gt; &lt;br/</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="sr">/div&gt;</span>
<span class="sr">&lt;/</span><span class="n">div</span><span class="o">&gt;</span></code></pre></div>

<p>script.js</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">angular</span><span class="o">.</span><span class="n">module</span><span class="p">(</span><span class="s1">&#39;myDemoModule&#39;</span><span class="p">,</span> <span class="o">[]</span><span class="p">)</span>
  <span class="o">.</span><span class="n">controller</span><span class="p">(</span><span class="s1">&#39;demoController&#39;</span><span class="p">,</span> <span class="o">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="vg">$scope</span><span class="p">)</span> <span class="p">{</span>
    <span class="vg">$scope</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;This is my Angular demo&#39;</span><span class="p">;</span>
<span class="p">}</span><span class="o">]</span><span class="p">);</span></code></pre></div>

<p>Một mẫu định nghĩa directive</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">var</span> <span class="n">myDemoModule</span> <span class="o">=</span> <span class="n">angular</span><span class="o">.</span><span class="n">module</span><span class="p">(</span><span class="s1">&#39;myDemoModule&#39;</span><span class="p">,</span> <span class="o">[]</span><span class="p">);</span>
<span class="n">myDemoModule</span><span class="o">.</span><span class="n">directive</span><span class="p">(</span><span class="err">‘</span><span class="n">myDemoDirective</span><span class="err">’</span><span class="p">,</span> <span class="n">function</span> <span class="n">factory</span><span class="p">(</span><span class="n">injectables</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="ss">restrict</span><span class="p">:</span> <span class="err">“</span><span class="no">AECM</span><span class="err">”</span><span class="p">,</span> <span class="sr">//</span> <span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">string</span>
    <span class="ss">priority</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="sr">//</span> <span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">number</span><span class="p">,</span>
    <span class="ss">template</span><span class="p">:</span> <span class="s2">&quot;&lt;p&gt;&lt;/p&gt;&quot;</span><span class="p">,</span> <span class="sr">//</span> <span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">string</span>
    <span class="ss">templateUrl</span><span class="p">:</span> <span class="err">“</span><span class="n">myDirectivesFolder</span> <span class="o">/</span> <span class="n">demoTempDirective</span><span class="o">.</span><span class="n">html</span><span class="err">”</span><span class="p">,</span> <span class="sr">//</span><span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">string</span>
    <span class="ss">replace</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="sr">//</span> <span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">boolean</span>
    <span class="ss">transclude</span><span class="p">:</span> <span class="kp">false</span><span class="p">,</span> <span class="sr">//</span> <span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">boolean</span>
    <span class="ss">scope</span><span class="p">:</span> <span class="p">{</span>
      <span class="ss">title</span><span class="p">:</span> <span class="s1">&#39;@&#39;</span>
    <span class="p">},</span> <span class="sr">//</span> <span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">bool</span> <span class="n">ho</span><span class="err">ặ</span><span class="n">c</span> <span class="n">object</span>
    <span class="ss">controller</span><span class="p">:</span> <span class="n">function</span> <span class="n">controllerConstructor</span><span class="p">(</span><span class="vg">$scope</span><span class="p">,</span> <span class="vg">$element</span><span class="p">,</span> <span class="vg">$attrs</span><span class="p">,</span> <span class="vg">$transclude</span><span class="p">)</span> <span class="p">{</span><span class="err">…</span><span class="p">},</span>
    <span class="nb">require</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;^myTabs&#39;</span><span class="p">,</span> <span class="s1">&#39;^myModel&#39;</span><span class="o">]</span><span class="p">,</span> <span class="sr">//</span> <span class="n">ki</span><span class="err">ể</span><span class="n">u</span> <span class="n">string</span>
    <span class="ss">link</span><span class="p">:</span> <span class="n">function</span> <span class="n">postLink</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">iElement</span><span class="p">,</span> <span class="n">iAttrs</span><span class="p">)</span> <span class="p">{</span><span class="err">…</span><span class="p">},</span>
    <span class="ss">compile</span><span class="p">:</span> <span class="n">function</span> <span class="n">compile</span><span class="p">(</span><span class="n">tElement</span><span class="p">,</span> <span class="n">tAttrs</span><span class="p">,</span> <span class="n">transclude</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="ss">pre</span><span class="p">:</span> <span class="n">function</span> <span class="n">preLink</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">iElement</span><span class="p">,</span> <span class="n">iAttrs</span><span class="p">,</span> <span class="n">controller</span><span class="p">)</span> <span class="p">{</span><span class="err">…</span><span class="p">},</span>
        <span class="ss">post</span><span class="p">:</span> <span class="n">function</span> <span class="n">postLink</span><span class="p">(</span><span class="n">scope</span><span class="p">,</span> <span class="n">iElement</span><span class="p">,</span> <span class="n">iAttrs</span><span class="p">,</span> <span class="n">controller</span><span class="p">)</span> <span class="p">{</span><span class="err">…</span><span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">});</span></code></pre></div>

<h1 id="gii-thch-cc-thuc-tnh-khai-bo">Giải thích các thuộc tính khai báo</h1>

<ul>
  <li>restrict : khai báo kiểu directive. Có các giá trị (A, E, C, M) tương ứng 4 kiểu directive.</li>
</ul>

<ol>
  <li>Kiểu <span class="green">a</span>ttribute (A)<br />
<span class="blue">&lt;div</span> <span class="red">my-directive</span><span class="blue">&gt;&lt;/div&gt;</span></li>
  <li>Kiểu <span class="green">e</span>lement (E)<br />
<span class="blue">&lt;my-directive&gt;&lt;/my-directive&gt;</span></li>
  <li>Kiểu <span class="green">c</span>lass (C)<br />
<span class="blue">&lt;div</span> class=<span class="red">”my-directive”</span><span class="blue">&gt;&lt;/div&gt;</span></li>
  <li>Kiểu co<span class="green">m</span>ment (C)<br />
<code>&lt;!-- directive: my-directive --&gt;</code></li>
</ol>

<p><ins>VD:</ins><br />
index.html</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">&lt;</span><span class="n">div</span> <span class="n">ng</span><span class="o">-</span><span class="n">app</span><span class="o">=</span><span class="s2">&quot;myDemoModule&quot;</span><span class="o">&gt;</span>
	<span class="o">&lt;</span><span class="n">div</span> <span class="n">ng</span><span class="o">-</span><span class="n">controller</span><span class="o">=</span><span class="s2">&quot;demoController&quot;</span><span class="o">&gt;</span>  
	        <span class="o">&lt;</span><span class="no">ANY</span> <span class="n">my</span><span class="o">-</span><span class="n">demo</span><span class="o">-</span><span class="n">directive</span><span class="o">&gt;&lt;</span><span class="no">ANY</span><span class="o">&gt;</span>
  	    <span class="o">&lt;</span><span class="n">my</span><span class="o">-</span><span class="n">demo</span><span class="o">-</span><span class="n">directive</span><span class="o">&gt;&lt;</span><span class="sr">/my-demo-directive&gt;</span>
<span class="sr">	    &lt;ANY class=&quot;my-demo-directive&quot;&gt;&lt;/</span><span class="no">ANY</span><span class="o">&gt;</span>
	    <span class="o">&lt;!--</span> <span class="ss">directive</span><span class="p">:</span> <span class="n">my</span><span class="o">-</span><span class="n">demo</span><span class="o">-</span><span class="n">directive</span> <span class="o">--&gt;</span>
	<span class="o">&lt;</span><span class="sr">/div&gt;</span>
<span class="sr">&lt;/</span><span class="n">div</span><span class="o">&gt;</span></code></pre></div>

<p>script.js</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">angular</span><span class="o">.</span><span class="n">module</span><span class="p">(</span><span class="s1">&#39;myDemoModule&#39;</span><span class="p">,</span> <span class="o">[]</span><span class="p">)</span>
      <span class="o">.</span><span class="n">directive</span><span class="p">(</span><span class="s1">&#39;myDemoDirective&#39;</span><span class="p">,</span> <span class="n">function</span><span class="p">(){</span>
    	   <span class="k">return</span> <span class="p">{</span>
		<span class="ss">restrict</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
		<span class="ss">template</span><span class="p">:</span> <span class="s1">&#39;&lt;p&gt;This is my Angular directive demo&lt;/p&gt;&#39;</span>
	   <span class="p">};</span>
<span class="p">});</span></code></pre></div>

</article>





      </div>
    </div>
  </div>

  <footer class="footer">
  <div class="p2 wrap">
    <div class="measure mt1 center">
      <small>
        xuantain's blog
      </small>
    </div>
  </div>
</footer>



</body>
</html>
